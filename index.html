<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>In_Context_Learning</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="./static/css/academicons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>

<body>


    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-desktop">
                <div class="columns is-centered">
                    <div class="column has-text-centered">


                        <h1 class="title is-1 publication-title">
                            In-context Imitation Learning for Articulated Object Manipulation
                        </h1>
                        <!-- <h3 class="title is-4 conference-authors"><a target="_blank" href="https://icml.cc/">ICML 2023</a>
                    </h3> --> 
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <div class="column">
                    <h2 class="title is-3">Abstract</h2>
                    <div class="content has-text-justified">
                        <p style="font-size: 125%">
                            Robotics manipulation of articulated objects has long been challenging due to the large variation of shapes, geometries, and articulation types of such objects. 
                            Although much prior work has attempted to learn a policy for manipulating such objects, such policies will often have failures when tested with out-of-distribution  objects not seen during training. 
                            In this paper, we explore in-context imitation learning for quick adaption of a manipulation policy for articulated object manipulation.
                            At the test-time, we provide an additional demonstration as input to the policy;
                            we condition the policy on this additional  demonstration so it can adapt to output correct actions. 
                            We explore several architectural design choices of how to condition the policy on an additional demonstration. 
                            To reduce the burden of teleoperating the robot to obtain the demonstration in the real world, we instead use a human demonstration, and we develop a system to transfer it to the robot policy. 
                            By using a single additional demonstration for each articulated object, our method improves the performance in simulation by 12.4\% on previously low-performing objects, and leads to 27\% improvement in performance when tested on challenging real-world objects. 
<br>
<br>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>









    <section class="section">
        <div class="container is-max-widescreen">
            <div class="rows">
                <div class="rows is-centered">
                    <div class="row is-full-width">
                        <h2 class="title is-3"><span class="dvima">In Context Imitation Learning System Overview</span></h2>
                        <!-- <img src="assets/pipeline.m4v" class="interpolation-image" alt=""
                            style="display: block; margin-left: auto; margin-right: auto; max-width: 80%;" /> -->
                            <video autoplay controls muted loop playsinline height="100%">
                              <source src="assets/overview-and-real-robot-results_including_hand.mp4"
                                      type="video/mp4">
                            </video>
                        <br>

                        <p style="font-size: 125%">
                          <span style="font-weight: bold">Overview</span>: Given an unseen object, a demonstration of opening the object is provided as an additional input to the policy. The policy is then conditioned on this incontext demonstration to successfully manipulate the unseen object. 
                        <br>
                        <span style="font-weight: bold">Network Architecture</span>: The policy network architecture takes as input current observation and demonstation as input. The current observation includes point cloud of the object besides the current EEF position. The demonstration includes the object point cloud in a different orientation along with the grasping and the opening EEF points in this different orientation. 
                        The current observation and the demonstration are then concatenated and passed to a Weighted Displacemene Model derived from prior work. The weighted displacement model outputs per point displacements and per point weights which are then aggregated to predict the subgoal EEF points. 
                        <br>
                        <span style="font-weight: bold">Human Demonstration in the real world</span>: We record the human demonstration as an RGBD image the real world and convert it to the robot EEF points. We first apply WiloR, a state of the art hand detection method to detect the human hand. We also use SAM to segment the human hand in the image. 
                        The WiloR hand mask is accurate but the predicted depth might be wrong. We scale the WiloR predicted depth with the real depth from the depth camera, which gives us an aligned hand mesh with the object from which we calculate the position and the orientation of the hand. Finally we convert this to the robot EEF points.  
                        </p>
                        </div>
                </div>
            </div>
        </div>
    </section>

    <!-- <section class="section">
        <div class="container is-max-widescreen">
            <div class="rows">
                <div class="rows is-centered ">
                    <div class="row is-full-width">
                        <h2 class="title is-3"><span class="dvima">Long-horizon task generation and learning</span></h2>
                        <img src="assets/images/long-horizon.png" class="interpolation-image" alt=""
                            style="display: block; margin-left: auto; margin-right: auto; max-width: 80%;" />
                        <br>
                        <span style="font-size: 125%">RoboGen is able to propose high-level tasks, generate corresponding environments, decompose the high-level goal into low-level subtasks, and then learn the sub-skills sequentially.
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </section> -->

    
    

  <section class="section">
    <div class="container is-max-widescreen">
  
  
  <div class="rows is-centered ">
    <div class="row is-full-width">
        <h2 class="title is-3"><span class="dvima">Performance of our In Context Imitation Learning method vs Articubot in Real Kitchens and Lounges </span></h2>
    </div>
</div>
<br>
<p style="font-size: 125%">
  We test our In Context Imitation learning policy and the baseline, Articubot policy in Kitchens on 5 unseen real-world articulated objects with a X-Arm on a mobile base using UMI gripper. We use 2 Azure Kinects as the cameras. 
  Videos are 6x speed.
</p>
<br>
<br>

  <div class="columns is-centered is-multiline">


    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
        <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 80%;">
            <source src="./assets/articubot_Cropped_SpeedUp_nsh4-oven.mp4"
                    type="video/mp4">
            </video>
            <p style="text-align:center; width: 80%;">Articubot fails to grasp the handle</p>
        </div>
    </div>

    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
    <div class="content" style="display: flex; flex-direction: column; align-items: center;">
        <video autoplay controls muted loop playsinline style="max-width: 80%;">
        <source src="./assets/DemoNsh_Oven_backup.mp4"
                type="video/mp4">
        </video>
        <p style="text-align:center; width: 80%;">(Ours) Human demo collected for Oven Demo</p>
    </div>
    </div>

    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
      <div class="content" style="display: flex; flex-direction: column; align-items: center;">
          <video autoplay controls muted loop playsinline style="max-width: 80%;">
          <source src="./assets/ours_Cropped_SpeedUp-nsh4-oven_speedup.mp4"
                  type="video/mp4">
          </video>
          <p style="text-align:center; width: 80%;">Our method opening Oven conditioned on the human demo</p>
      </div>
      </div>




    
    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
    <div class="content" style="display: flex; flex-direction: column; align-items: center;">
        <video autoplay controls muted loop playsinline style="max-width: 80%;">
        <source src="./assets/articubot-fail-1_Cropping_SpeedUp_nsha_cabinet.mp4"
                type="video/mp4">
        </video>
        <p style="text-align:center; width: 80%;">Articubot fails to grasp</p>
    </div>
    </div>


      
    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
    <div class="content" style="display: flex; flex-direction: column; align-items: center;">
        <video autoplay controls muted loop playsinline style="max-width: 80%;">
        <source src="./assets/Demo_NSH_Cabinet_backup.mp4"
                type="video/mp4">
        </video>
        <p style="text-align:center; width: 80%;">(Ours) Human demo collected for Cabinet 1</p>
    </div>
    </div>

    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
      <div class="content" style="display: flex; flex-direction: column; align-items: center;">
          <video autoplay controls muted loop playsinline style="max-width: 80%;">
          <source src="./assets/ours-partially-open_Cropped_SpeedUp-nsh-a-cabinet.mp4"
                  type="video/mp4">
          </video>
          <p style="text-align:center; width: 80%;">Our method opening Cabinet 1 conditioned on the human demo </p>
      </div>
      </div>



      





    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
    <div class="content" style="display: flex; flex-direction: column; align-items: center;">
        <video autoplay controls muted loop playsinline style="max-width: 80%;">
        <source src="./assets/articubot-failure-2_Cropped_SpeedUp-robolounge-cabinet.mp4"
                type="video/mp4">
        </video>
        <p style="text-align:center; width: 80%;">Articubot fails to grasp</p>
    </div>
    </div> 

    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
    <div class="content" style="display: flex; flex-direction: column; align-items: center;">
        <video autoplay controls muted loop playsinline style="max-width: 80%;">
        <source src="./assets/demo_Robo_Cabinet_Blurred_backup.mp4"
                type="video/mp4">
        </video>
        <p style="text-align:center; width: 80%;">(Ours) Human demo collected for Cabinet 2</p>
    </div>
    </div> 

    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
      <div class="content" style="display: flex; flex-direction: column; align-items: center;">
          <video autoplay controls muted loop playsinline style="max-width: 80%;">
          <source src="./assets/ours-1_Cropped_SpeedUp-robo-cabinet.mp4"
                  type="video/mp4">
          </video>
          <p style="text-align:center; width: 80%;">Our method opening Cabinet 2 conditioned on the human demo</p>
      </div>
      </div> 








    
    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
        <div class="content" style="display: flex; flex-direction: column; align-items: center;">
          <video autoplay controls muted loop playsinline style="max-width: 80%;">
            <source src="./assets/Articubot_1_SpeedUp.mp4"
                    type="video/mp4">
          </video>
          <p style="text-align:center; width: 80%;">Articubot fails to grasp</p>
        </div>
      </div> 

    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
      <div class="content" style="display: flex; flex-direction: column; align-items: center;">
        <video autoplay controls muted loop playsinline style="max-width: 80%;">
          <source src="./assets/Demo_Robo_Top_Drawer_backup.mp4"
                  type="video/mp4">
        </video>
        <p style="text-align:center; width: 80%;">(Ours) Human demo collected for Drawer</p>
      </div>
    </div>  

    <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
      <div class="content" style="display: flex; flex-direction: column; align-items: center;">
        <video autoplay controls muted loop playsinline style="max-width: 80%;">
          <source src="./assets/Our_Method_1_Cropped.mp4"
                  type="video/mp4">
        </video>
        <p style="text-align:center; width: 80%;">Our method opening Drawer conditioned on the human demo</p>
      </div>
    </div> 
    
    
  </div>
</section>



  <section class="section">
    <div class="container is-max-widescreen">
  
  
      <div class="rows is-centered ">
        <div class="row is-full-width">
            <h2 class="title is-3"><span class="dvima">Performance of our In Context Imitation Learning method vs Articubot opening Table-top objects</span></h2>
        </div>
    </div>
    <br>
    <p style="font-size: 125%">
    We test our In Context Imitation learning policy and the baseline, Articubot policy on 5 unseen articulated objects on a table top with Franka Arm  and two Azure Kinects cameras.
    Videos are 6x speed.
    </p>
    <br>
    <br>
  
      <div class="columns is-centered is-multiline">
        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/Articubot_1_Cropped_fridge_speedup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Articubot fails to grasp</p>
          </div>
        </div>

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/demo_toy_fridge_backup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">(Ours) Human demo collected for Toy Fridge</p>
          </div>
        </div>  

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/Our_1_Cropped_fridge_speedup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Our method opening table top toy fridge conditioned on the human demo</p>
          </div>
        </div>
        






        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
            <div class="content" style="display: flex; flex-direction: column; align-items: center;">
              <video autoplay controls muted loop playsinline style="max-width: 95%;">
                <source src="./assets/3_layer_Articubot_2_Cropped_SppedUp.mp4"
                        type="video/mp4">
              </video>
              <p style="text-align:center; width: 100%;">Articubot graps but fails to open</p>
            </div>
          </div> 



        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/demo_3_layered_cabinet_backup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">(Ours) Human demo collected for 3 layered cabinet</p>
          </div>
        </div> 
        
        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/3_layer_Cabinet_Our_2_Cropped_SpeedUp.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Our method opening 3 layered cabinet conditioned on the human demo</p>
          </div>
        </div>






        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/White_Drawer_Articubot_Baseline_Cropped_Speedup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Articubot fails to open fully due to wrong opening predictions</p>
          </div>
        </div>  

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/demo_white_drawer_backup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">(Ours) Human demo collected for White Drawer</p>
          </div>
        </div>  

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/White_Drawer_From_GIF.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Our method opening white drawer conditioned on the human demo</p>
          </div>
        </div> 







        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/Articubot_Baseline_Knob_Cabinet_Cropped_Speedup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Articubot partially opens knob cabinet</p>
          </div>
        </div>  

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/demo_knob_cabinet_backup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">(Ours) Human demo collected for Knob Cabinet</p>
          </div>
        </div>  

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/In_Context_Learning_Knob_Cabinet_Cropped_Speedup.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Our method opening knob cabinet conditioned on the human demo </p>
          </div>
        </div> 







        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/Articubot_Baseline_Toy_Oven.mp4"
                      type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">Articubot partially opening the Toy Oven due to wrong prediction</p>
          </div>
        </div>  

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
        <div class="content" style="display: flex; flex-direction: column; align-items: center;">
            <video autoplay controls muted loop playsinline style="max-width: 95%;">
            <source src="./assets/Demo_Oven_backup.mp4"
                    type="video/mp4">
            </video>
            <p style="text-align:center; width: 100%;">(Ours) Human demo collected for Toy Oven </p>
        </div>
        </div> 

        <div class="column is-one-third" style="padding-left: 2px; padding-right: 2px;">
          <div class="content" style="display: flex; flex-direction: column; align-items: center;">
              <video autoplay controls muted loop playsinline style="max-width: 95%;">
              <source src="./assets/Oven_from_GIF.mp4"
                      type="video/mp4">
              </video>
              <p style="text-align:center; width: 100%;">Our method opening table top toy oven conditioned on the human demo </p>
          </div>
          </div> 
        
      </div>
    </section>


   
      <!-- interactive examples of long horizon tasks -->
      <section class="section">
        <div class="container is-max-widescreen">
            <div class="rows">
                <div class="rows is-centered">
                    <div class="row is-full-width">
                        <h2 class="title is-3"><span class="dvima">Visualizations of demos that we collected</span></h2>
                        <p style="font-size: 125%">Please click an image below to view the demos that have been collected.</p>
                    </div>
                </div>
            </div>
            <br>
            
            <!-- First row with 7 images -->
            <div class="columns is-centered">
              <div class="column is-full-width" style="display: flex; flex-wrap: wrap; justify-content: center;">
                  <img src="assets/DemoNsh_Oven.png" width="10%" height="auto" style="border-radius: 10px; margin: 5px; object-fit: cover; aspect-ratio: 1/1;" alt='Oven Demo' onclick="populateDemo(this, 1);">
                  <img src="assets/Demo_Robo_Top_Drawer.png" width="10%" height="auto" style="border-radius: 10px; margin: 5px; object-fit: cover; aspect-ratio: 1/1;" alt='Drawer Demo' onclick="populateDemo(this, 1);">
                  <img src="assets/demo_toy_fridge.png" width="10%" height="auto" style="border-radius: 10px; margin: 5px; object-fit: cover; aspect-ratio: 1/1;" alt='Toy Fridge Demo' onclick="populateDemo(this, 1);">
                  <img src="assets/demo_3_layered_cabinet.png" width="10%" height="auto" style="border-radius: 10px; margin: 5px; object-fit: cover; aspect-ratio: 1/1;" alt='3 layered Cabinet Demo' onclick="populateDemo(this, 1);">
                  <img src="assets/demo_white_drawer.png" width="10%" height="auto" style="border-radius: 10px; margin: 5px; object-fit: cover; aspect-ratio: 1/1;" alt='White Drawer Demo' onclick="populateDemo(this, 1);">
                  <img src="assets/demo_knob_cabinet.png" width="10%" height="auto" style="border-radius: 10px; margin: 5px; object-fit: cover; aspect-ratio: 1/1;" alt='Knob Cabinet Demo' onclick="populateDemo(this, 1);">
                  <img src="assets/Demo_Oven.png" width="10%" height="auto" style="border-radius: 10px; margin: 5px; object-fit: cover; aspect-ratio: 1/1;" alt='Toy Oven Demo' onclick="populateDemo(this, 1);">
                </div>
          </div>
          
            <!-- Video Player -->
            <div class="row border rounded" style="padding-top:2px; padding-bottom:12px; margin-top: 20px;">
                <div class="col-md-6">
                    <video id="demo-video-1" style="border-radius: 5px; width: 100%;" autoplay loop muted webkit-playsinline playsinline onclick="setAttribute('controls', 'true');">
                        <source id="expandedImg-1" src="assets/select.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
            
            <!-- Text description -->
            <!-- <div class="col-md-6">
                <div id="imgtext-1" style="font-size: 1.5em">Select an image above to show the RoboGen results:</div>
                <div>
                    <pre class="p-1 scrollable"><code class="language-python" id="answer-1">RoboGen response shown within code block.</code></pre>
                </div>
            </div> -->
        </div>
    </section>
    
    <script>
    function populateDemo(img, demoId) {
        const videoSource = document.getElementById("expandedImg-" + demoId);
        const videoElement = document.getElementById("demo-video-" + demoId);
        const textElement = document.getElementById("imgtext-" + demoId);
    
        // Extract the video path based on the image source
        const videoPath = img.src.replace('.png', '.mp4').replace('assets/', 'assets/');
        videoSource.src = videoPath;
        videoElement.load(); // Reload video with new source
    
        // Update the text description
        textElement.innerHTML = img.alt;
    }
    </script>
    
          

        

    <footer class="footer">
        <div class="container">
            <div class="columns is-centered">
                <div class="column">
                    <div class="content has-text-centered">
                        <p>
                            Website template borrowed from <a
                                href="https://robogen-ai.github.io/">RoboGen</a> and <a
                                href="https://eureka-research.github.io/">Eureka</a>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

</body>

<script>

  timeoutIds = [];

  function typeWriter(txt, i, q, num, text1, text2) {
      var imgText = document.getElementById(text1 + num);
      var answer = document.getElementById(text2 + num);
      if (imgText.innerHTML == q) {
          for (let k = 0; k < 5; k++) {
              if (i < txt.length) {
                  if (txt.charAt(i) == "\\") {
                      answer.innerHTML += "\n";
                      i += 1;
                  } else {
                      answer.innerHTML += txt.charAt(i);
                  }
                  i++;
              }
          }
          hljs.highlightAll();
          timeoutIds.push(setTimeout(typeWriter, 1, txt, i, q, num, text1, text2));
      }
  }

</script>

</html>